function I = Moments(im)

    [Y,X,c] = size(im);

    M00 = 0;
    M10 = 0;
    M01 = 0;

    for y=1:Y
        for x=1:X
            f(y,x) = double(im(y,x));
            M00 = M00 + f(y,x);
            M10 = M10 + x*f(y,x);
            M01 = M01 + y*f(y,x);
        end
    end

    xc = M10/M00;
    yc = M01/M00;

    mu = zeros(4,4);
    for i=0:3
        for j=0:3
            if i+j>3
                continue
            end
            for y=1:Y
                for x=1:X
                    mu(i+1,j+1) = mu(i+1,j+1) + (x-xc)^i * (y-yc)^j * f(y,x);
                end
            end
            if i+j >= 2
                n(i+1,j+1) = mu(i+1,j+1) /( mu(1,1)^(1+(i+j)/2) );
            end
        end
    end

    I(1) = n(3,1) + n(1,3);
    I(2) = (n(3,1) - n(1,3))^2 + 4*n(2,2)^2;
    I(3) = (n(4,1) - 3*n(2,3))^2 + (3*n(3,2) - n(1,4))^2;
    I(4) = (n(4,1) + n(2,3))^2 + (n(3,2) + n(1,4))^2;
    I(5) = (n(4,1) - 3*n(2,3))*(n(4,1) + n(2,3))*((n(4,1) + n(2,3))^2 - 3*(n(3,2) + n(1,4))^2) + (3*n(3,2) - n(1,4))*(n(3,2) + n(1,4))*(3*(n(4,1) + n(2,3))^2 - (n(3,2) + n(1,4))^2);
    I(6) = (n(3,1) - n(1,3))*((n(4,1) + n(2,3))^2 - (n(3,2) + n(1,4))^2) + 4*n(2,2)*(n(4,1) + n(2,3))*(n(3,2) + n(1,4));
    I(7) = (3*n(3,2) - n(1,4))*(n(4,1) + n(2,3))*((n(4,1) + n(2,3))^2 - 3*(n(3,2) + n(1,4))^2) - (n(4,1) - 3*n(2,3))*(n(3,2) + n(1,4))*(3*(n(4,1) + n(2,3))^2 - (n(3,2) + n(1,4))^2);
        
end